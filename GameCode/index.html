<!DOCTYPE html>
<html>
<head>
    <script src="./lib/phaser.min.js"></script>
    <script src="./plane.js"></script>
    <script src="./grid.js"></script>
</head>
<body>

    <script>
        var config = {
            type: Phaser.AUTO,
            parent: 'canvas',
            backgroundColor: '#cea77d',
            width: 1024,
            height: 800,
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };    

        var game = new Phaser.Game(config);

        var planes = [];
        var keySpace;
        function preload () {
            this.load.image("plane", "images/plane.jpeg");
        }
        
        function create () {
            var SELF = this;
            this.add.text(250, 5, 'Mine Planes', { font: '16px Courier', fill: '#ffffff' });
            this.add.text(700, 5, 'Enemy Planes', { font: '16px Courier', fill: '#ffffff' });

            drawGrid(400, 400, this.add.graphics({x: 100, y: 30}))
            drawGrid(400, 400, this.add.graphics({x: 550, y: 30}))

            var plane = new Plane(this, 50, 70);
            planes.push(plane);
            this.children.add(plane);

            plane.setInteractive();
            this.input.setDraggable(plane);

            this.input.on('drag', function (pointer, gameObject, dragX, dragY) {

                if (planes.length >= 3) {
                    gameObject.x = dragX;
                    gameObject.y = dragY;
                } else {
                    var p = new Plane(SELF, dragX, dragY);
                    p.setInteractive();
                    SELF.input.setDraggable(p);
                    planes.push(p);
                    SELF.children.add(p);
                }
            });

            keySpace = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);
        }

        function update () {

        }
    </script>

    <div id="canvas"></div>

</body>
</html>