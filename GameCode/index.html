<!DOCTYPE html>
<html>
<head>
    <script src="./lib/phaser.min.js"></script>
    <script src="./plane.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nebpay.js@0.2.0/dist/nebPay.min.js"></script>
    <script src="walletWrapper.js"></script>
    <script src="./grid.js"></script>
</head>
<body>

    <script>
        var config = {
            type: Phaser.AUTO,
            parent: 'canvas',
            width: 1024,
            height: 800,
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };    

        var game = new Phaser.Game(config);

        var planes = [];

        function preload () {
            this.load.image("plane", "images/plane.jpeg");
        }
        
        function create () {
            var SELF = this;

            drawGrid(400, 400, this.add.graphics({x: 100, y: 10}))
            drawGrid(400, 400, this.add.graphics({x: 550, y: 10}))

            var plane = new Plane(this, 50, 50);
            planes.push(plane);
            this.children.add(plane);

            plane.setInteractive();
            this.input.setDraggable(plane);

            this.input.on('drag', function (pointer, gameObject, dragX, dragY) {

                if (planes.length >= 3) {
                    gameObject.x = dragX;
                    gameObject.y = dragY;
                } else {
                    var p = new Plane(SELF, dragX, dragY);
                    p.setInteractive();
                    SELF.input.setDraggable(p);
                    planes.push(p);
                    SELF.children.add(p);
                }
            });
        }

        function update (time, delta) {

        }
    </script>

    <div id="canvas"></div>

</body>
</html>