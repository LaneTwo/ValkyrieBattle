# 瓦格雷（女武神）战机大战设计


## 游戏流程

- 玩家A创建飞机布局数据，提交布局(salt + hash)
- 玩家B创建飞机布局数据，提交布局(salt + hash)
- SmartContract匹配玩家A+B，更新游戏状态（等待开局）
- 玩家A确认开局，玩家B确认开局，更新游戏状态（游戏开始，先确认者先行）
- 玩家A，B轮流投弹，玩家A投弹后，玩家B需要更新己方状态（是否击中，击中部位）后再投弹
- 当一方击毁对方全部3架飞机后，可以发起终局申请
- 双方需要提交原始布局数据 + salt给SmartContract
- SmartContract验证飞机布局数据hash，不匹配者判负
- SmartContract验证是否终局，如果未终局，则判提交终局申请者负
- SmartContract根据终局状态更新游戏状态（胜负状态，玩家胜负计数）
- 超时逻辑：
    - 开局响应应在1分钟内完成，若一方未响应，则游戏未配对，玩家可以继续提出配对请求
    - 每步在2分钟内完成，另一方无响应，则可以提交超时终局申请，SmartContract判对方付
    - 一方提出终局申请后，另一方未在1分钟内提交飞机布局数据，则申请方可在超时后提交请求直接判对方负



## SmartContract


- 游戏开局: 保存飞机布局的hash数据


## 游戏DApp前端

- 可以用Phaser实现
- 复用SmartContract的游戏逻辑部分（js代码）

